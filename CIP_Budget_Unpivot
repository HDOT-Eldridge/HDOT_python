import pandas as pd
import api

#import the CIP Budget file off of the api
df = api.get("nuua-b48h")

print(df)

# pandas.melt- Unpivot a DataFrame from wide to long format, optionally leaving identifiers set.
# This function is useful to massage a DataFrame into a format where one or more columns are identifier variables (id_vars), while all other columns, considered
# measured variables (value_vars), are “unpivoted” to the row axis, leaving just two non-identifier columns, ‘variable’ and ‘value

df_melt = df.melt(id_vars=['sort_order','dept_pri', 'progid', 'source', 'cpn', 'item_no', 'title',	'mof','notes', 'hwy_ok', 'island',	'legapprovalstatus', 'trn',
],
value_vars= ['gdfy20', 'gdfy21'],
var_name="GDFY",
value_name="Total")

df_melt.to_csv('C:/Socrata/Data/Dev/melt_demo.csv', index=False)
